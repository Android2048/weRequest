/*!
 * weRequest 1.1.0
 * https://github.com/IvinWu/weRequest
 */
module.exports=function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=8)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={sessionName:"session",loginTrigger:function(){return!1},codeToSession:{},successTrigger:function(){return!0},urlPerfix:"",successData:function(e){return e},doNotCheckSession:!1,errorTitle:"操作失败",errorContent:function(e){return e},reLoginLimit:3,errorCallback:null,reportCGI:!1,mockJson:!1,globalData:!1,sessionExpireKey:"sessionExpireKey"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={session:"",sessionExpireTime:null,sessionExpire:1/0,sessionIsFresh:!1,logining:!1,isCheckingSession:!1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(11),o=n(0),u=n(1),f=n(12),s=n(6),l=n(7),c=n(3),d=n(5),r=n(4);function a(e){var t=this;return"function"==typeof e.beforeSend&&e.beforeSend(),void 0===e.reLoginLimit?e.reLoginLimit=0:e.reLoginLimit++,void 0===e.count&&(e.count=0),e.showLoading&&(i.default.show(e.showLoading),e.complete=function(e){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];return function(){i.default.hide(),"function"==typeof e&&e.apply.apply(e,[t].concat(n))}}(e.complete)),e.originUrl=e.url,e.url=function(e){if(e.startsWith("http"))return e;var t=o.default.urlPerfix;return"function"==typeof o.default.urlPerfix&&(t=o.default.urlPerfix()),t+e}(e.url),e}function p(e){(e=function(e,t){e[t]||(e[t]={}),e.originUrl!==o.default.codeToSession.url&&u.default.session&&(e[t][o.default.sessionName]=u.default.session);var n={};if("function"==typeof o.default.globalData?n=o.default.globalData():"object"==typeof o.default.globalData&&(n=o.default.globalData),e[t]=Object.assign({},n,e[t]),e.method=e.method||"GET",e.dataType=e.dataType||"json","GET"!==e.method)for(var i in u.default.session&&(e.url.indexOf("?")>=0?e.url+="&"+o.default.sessionName+"="+encodeURIComponent(u.default.session):e.url+="?"+o.default.sessionName+"="+encodeURIComponent(u.default.session)),n)e.url.indexOf("?")>=0?e.url+="&"+i+"="+n[i]:e.url+="?"+i+"="+n[i];return r.default.start(e),e}(e,"data")).count++,wx.request({url:e.url,data:e.data,method:e.method,header:e.header||{},dataType:e.dataType||"json",success:function(t){d.default(t,e,"request")},fail:function(t){c.default(e,t),console.error(t)},complete:function(){e.count--,"function"==typeof e.complete&&0===e.count&&e.complete()}})}t.default={request:function(e){if(e=a(e),o.default.mockJson)return f.default.get(e,"request"),!1;e.cache&&s.default.get(e),l.default(function(){p(e)},e)},uploadFile:function(e){if(e=a(e),o.default.mockJson)return f.default.get(e,"uploadFile"),!1;e.cache&&s.default.get(e),l.default(function(){!function(e){e.count++,wx.uploadFile({url:e.url,filePath:e.filePath||"",name:e.name||"",formData:e.formData,success:function(t){d.default(t,e,"uploadFile")},fail:function(t){c.default(e,t),console.error(t)},complete:function(){e.count--,"function"==typeof e.complete&&0===e.count&&e.complete()}})}(e)},e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0);t.default=function(e,t){if("function"==typeof e.fail)e.fail(t);else{var n="";if("function"==typeof i.default.errorTitle)try{n=i.default.errorTitle(t.data||t.errMsg)}catch(e){}else"string"==typeof i.default.errorTitle&&(n=i.default.errorTitle);var o="";if("function"==typeof i.default.errorContent)try{o=i.default.errorContent(t.data||t.errMsg)}catch(e){}else"string"==typeof i.default.errorContent&&(o=i.default.errorContent);wx.showModal({title:n,content:o||"网络或服务异常，请稍后重试",showCancel:!1})}"function"==typeof i.default.errorCallback&&i.default.errorCallback(e,t),console.error(t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0);t.default={start:function(e,t){switch(t){case"checkSession":e._checkSessionStartTime=(new Date).getTime();break;case"login":e._loginStartTime=(new Date).getTime();break;default:e.report&&(e._reportStartTime=(new Date).getTime())}},end:function(e,t){switch(t){case"checkSession":e._checkSessionEndTime=(new Date).getTime(),"function"==typeof i.default.reportCGI&&i.default.reportCGI("wx_checkSession",e._checkSessionStartTime,e._checkSessionEndTime);break;case"login":e._loginEndTime=(new Date).getTime(),"function"==typeof i.default.reportCGI&&i.default.reportCGI("wx_login",e._loginStartTime,e._loginEndTime);break;default:e.report&&"function"==typeof i.default.reportCGI&&(e._reportEndTime=(new Date).getTime(),i.default.reportCGI(e.report,e._reportStartTime,e._reportEndTime))}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(1),u=n(2),f=n(3),s=n(6),l=n(4);t.default=function(e,t,n){if(200===e.statusCode){if("string"==typeof e.data)try{e.data=JSON.parse(e.data)}catch(n){return f.default(t,e),!1}if(l.default.end(t),t.isLogin){var c="";try{c=i.default.codeToSession.success(e.data)}catch(e){}c?t.success(c):f.default(t,e)}else if(i.default.loginTrigger(e.data)&&t.reLoginLimit<i.default.reLoginLimit)o.default.session="",o.default.sessionIsFresh=!0,wx.removeStorage({key:i.default.sessionName,complete:function(){u.default[n](t)}});else if(i.default.successTrigger(e.data)&&"function"==typeof t.success){var d=null;try{d=i.default.successData(e.data)}catch(e){console.error("Function successData occur error: "+e)}t.noCacheFlash||t.success(d),s.default.set(t,d)}else f.default(t,e)}else f.default(t,e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={get:function(e){wx.getStorage({key:e.originUrl,success:function(t){"function"==typeof e.cache&&e.cache(t.data)?"function"==typeof e.success&&e.success(t.data,{isCache:!0}):1==e.cache&&"function"==typeof e.success&&e.success(t.data,{isCache:!0}),"function"==typeof e.complete&&e.complete()}})},set:function(e,t){(!0===e.cache||"function"==typeof e.cache&&e.cache(t))&&wx.setStorage({key:e.originUrl,data:t})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(13),o=n(1),u=n(0),f=n(2),s=n(3),l=n(4);function c(e,t){t.isLogin?"function"==typeof e&&e():o.default.session?o.default.sessionExpireTime&&(new Date).getTime()>o.default.sessionExpire?(o.default.session="",c(e,t)):"function"==typeof e&&e():o.default.logining?i.default.wait("doLoginFinished",function(){c(e,t)}):(o.default.logining=!0,t.count++,l.default.start(t,"login"),console.log("wx.login"),wx.login({complete:function(){t.count--,l.default.end(t,"login"),"function"==typeof t.complete&&0===t.count&&t.complete()},success:function(n){n.code?function(e,t,n){var s;s="function"==typeof u.default.codeToSession.data?u.default.codeToSession.data():u.default.codeToSession.data||{};s[u.default.codeToSession.codeName]=t,e.count++,f.default.request({url:u.default.codeToSession.url,data:s,method:u.default.codeToSession.method||"GET",isLogin:!0,report:u.default.codeToSession.report||u.default.codeToSession.url,success:function(e){o.default.session=e,o.default.sessionIsFresh=!0,o.default.sessionExpireTime&&(o.default.sessionExpire=(new Date).getTime()+o.default.sessionExpireTime,wx.setStorage({key:u.default.sessionExpireKey,data:String(o.default.sessionExpire)})),"function"==typeof n&&n(),wx.setStorage({key:u.default.sessionName,data:o.default.session})},complete:function(){e.count--,"function"==typeof e.complete&&0===e.count&&e.complete(),o.default.logining=!1,i.default.emit("doLoginFinished")},fail:u.default.codeToSession.fail||null})}(t,n.code,e):(s.default(t,n),console.error(n),o.default.logining=!1,i.default.emit("doLoginFinished"))},fail:function(e){s.default(t,e),console.error(e),o.default.logining=!1,i.default.emit("doLoginFinished")}}))}t.default=function e(t,n){o.default.isCheckingSession?i.default.wait("checkSessionFinished",function(){e(t,n)}):!o.default.sessionIsFresh&&o.default.session?(o.default.isCheckingSession=!0,n.count++,l.default.start(n,"checkSession"),wx.checkSession({success:function(){o.default.sessionIsFresh=!0},fail:function(){o.default.session=""},complete:function(){o.default.isCheckingSession=!1,n.count--,l.default.end(n,"checkSession"),c(t,n),i.default.emit("checkSessionFinished")}})):c(t,n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(9),o=n(10),u=n(14),f=n(15),s=n(16),l=n(17),c=n(18),d={init:i.default,request:o.default,uploadFile:u.default,setSession:f.default,login:s.default,getSession:l.default,getConfig:c.default};t.default=d},function(e,t,n){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),u=n(1);t.default=function(e){var t=i({},e,o.default);if(e.sessionName)try{u.default.session=wx.getStorageSync(t.sessionName)||""}catch(e){console.error("wx.getStorageSync:fail, can not get session.")}if(e.sessionExpireKey)try{u.default.sessionExpire=wx.getStorageSync(t.sessionExpireKey)||1/0}catch(e){console.error("wx.getStorageSync:fail, can not get sessionExpire.")}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(2);t.default=function(e){i.default.request(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={show:function(e){wx.showToast({title:"boolean"==typeof e?"加载中":e,icon:"loading",mask:!0,duration:6e4})},hide:function(){wx.hideToast({})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(5);t.default={get:function(e,t){if(!i.default.mockJson[e.url]&&!i.default.mockJson[e.originUrl])return console.error("mock 没有对应接口的数据"),!1;var n=i.default.mockJson[e.url]||i.default.mockJson[e.originUrl],u={data:n=JSON.parse(JSON.stringify(n)),statusCode:200};o.default(u,e,t)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={};function o(e){return i[e]||(i[e]={waitingList:[]}),i[e]}t.default={wait:function(e,t){o(e).waitingList.push(t)},emit:function(e){for(var t=o(e),n=t.waitingList.length,i=0;i<n;i++){var u=t.waitingList.shift();"function"==typeof u&&u()}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(2);t.default=function(e){i.default.uploadFile(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1);t.default=function(e){i.default.session=e,i.default.sessionIsFresh=!0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(7);t.default=function(e){return i.default(e,{})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1);t.default=function(){return i.default.session}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(1);t.default=function(){return{urlPerfix:i.default.urlPerfix,sessionExpireTime:o.default.sessionExpireTime,sessionExpireKey:i.default.sessionExpireKey,sessionExpire:o.default.sessionExpire}}}]);