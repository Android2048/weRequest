module.exports=function(e){function t(o){if(n[o])return n[o].exports;var c=n[o]={i:o,l:!1,exports:{}};return e[o].call(c.exports,c,c.exports,t),c.l=!0,c.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:o})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,n){function o(e,t){j?setTimeout(function(){o(e,t)},500):!E&&O?(j=!0,t.count++,t._checkSessionStartTime=(new Date).getTime(),wx.checkSession({success:function(){E=!0},fail:function(){O=""},complete:function(){j=!1,t.count--,t._checkSessionEndTime=(new Date).getTime(),"function"==typeof L&&L("wx_checkSession",t._checkSessionStartTime,t._checkSessionEndTime,r),c(e,t)}})):c(e,t)}function c(e,t){O?"function"==typeof e&&e():C?setTimeout(function(){c(e,t)},500):(C=!0,t.count++,t._loginStartTime=(new Date).getTime(),wx.login({complete:function(){t.count--,t._loginEndTime=(new Date).getTime(),"function"==typeof L&&L("wx_login",t._loginStartTime,t._loginEndTime,r),"function"==typeof t.complete&&0==t.count&&t.complete()},success:function(n){n.code?(t[h]=n.code,delete t[m],"function"==typeof e&&e()):(u(t,n),console.error(n)),C=!1},fail:function(e){u(t,e),console.error(e),C=!1}}))}function i(e){return"function"==typeof e.beforeSend&&e.beforeSend(),void 0===e.reLoginLimit?e.reLoginLimit=0:e.reLoginLimit++,void 0===e.count&&(e.count=0),e.showLoading&&(p.show(e.showLoading),e.complete=function(e){return function(){p.hide(),"function"==typeof e&&e.apply(this,arguments)}}(e.complete)),e}function r(e){e.count++,e.data||(e.data={}),O&&(e[m]=O);var t={};"function"==typeof D?t=D():"object"==typeof D&&(t=D),e.data=Object.assign({},t,e.data),e.method=e.method||"GET";var n=e.url.startsWith("http")?e.url:w+e.url;e[h]&&(n.indexOf("?")>=0?n+="&"+h+"="+e[h]:n+="?"+h+"="+e[h]),e[m]&&(n.indexOf("?")>=0?n+="&"+m+"="+e[m]:n+="?"+m+"="+e[m]);for(var o in t)n.indexOf("?")>=0?n+="&"+o+"="+t[o]:n+="?"+o+"="+t[o];e.report&&(e._reportStartTime=(new Date).getTime()),wx.request({url:n,data:e.data,method:e.method,header:e.header||{},dataType:e.dataType||"json",success:function(t){if(200==t.statusCode)if(e.report&&"function"==typeof L&&(e._reportEndTime=(new Date).getTime(),L(e.report,e._reportStartTime,e._reportEndTime,r)),g(t.data)&&g(t.data)!=O&&(O=g(t.data),wx.setStorage({key:m,data:g(t.data)})),y(t.data)&&e.reLoginLimit<k)O="",wx.removeStorage({key:m,complete:function(){c(function(){e=i(e),r(e)},e)}});else if(T(t.data)&&"function"==typeof e.success){var n=null;try{n=x(t.data)}catch(e){console.error("Function successData occur error: "+e)}e.success(n),(!0===e.cache||"function"==typeof e.cache&&e.cache(n))&&wx.setStorage({key:e.url,data:n})}else u(e,t);else u(e,t)},fail:function(t){u(e,t),console.error(t)},complete:function(){e.count--,"function"==typeof e.complete&&0==e.count&&e.complete()}})}function u(e,t){if("function"==typeof e.fail)e.fail(t);else{var n="";if("function"==typeof S)try{n=S(t.data)}catch(e){}else"string"==typeof S&&(n=S);var o="";if("function"==typeof _)try{o=_(t.data)}catch(e){}else"string"==typeof _&&(o=_);wx.showModal({title:n,content:o||"网络或服务异常，请稍后重试",showCancel:!1})}"function"==typeof v&&v(e,t),console.error(t)}function s(e,t){e.cache?wx.getStorage({key:e.url,success:function(t){"function"==typeof e.cache&&e.cache(t.data)?"function"==typeof e.success&&e.success(t.data):1==e.cache&&"function"==typeof e.success&&e.success(t.data)},fail:function(){t()}}):t()}function a(e){m=e.sessionName||"session",y=e.loginTrigger||function(){return!1},h=e.codeName||"code",T=e.successTrigger||function(){return!0},g=e.getSession||function(e){return e.session_id},w=e.urlPerfix||"",x=e.successData||function(e){return e},S=e.errorTitle||"操作失败",_=e.errorContent||!1,k=e.reLoginLimit||3,v=e.errorCallback||null,E=e.doNotCheckSession||!1,L=e.reportCGI||!1,b=e.mockJson||!1,D=e.globalData||!1;try{O=wx.getStorageSync(m)||""}catch(e){}}function f(e){e=i(e),b&&b[e.url]?d(e):s(e,function(){o(function(){r(e)},e)})}function l(e){O=e,E=!0}function d(e){var t={data:JSON.parse(JSON.stringify(b[e.url]))};T(t.data)&&"function"==typeof e.success?e.success(x(t.data)):u(e,t),"function"==typeof e.complete&&e.complete()}const p=n(1);var m="session",y=function(){return!1},g=function(e){return e.session_id},h="code",T=function(){return!0},w="",x=function(e){return e},S="操作失败",_=function(e){return e},k=3,v=null,L=!1,b=!1,D=!1,O="",E=!1,C=!1,j=!1;e.exports={init:a,request:f,setSession:l}},function(e,t){function n(e){wx.showToast({title:"boolean"==typeof e?"加载中":e,icon:"loading",mask:!0,duration:6e4})}function o(){wx.hideToast()}e.exports={show:n,hide:o}}]);