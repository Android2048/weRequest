module.exports=function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:o})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=2)}([function(e,t){var n={};function o(e){return n[e]||(n[e]={waitingList:[],result:null}),n[e]}e.exports={wait:function(e,t){var n=o(e);n.result?t(n.result):n.waitingList.push(t)},emit:function(e,t){var n=o(e);n.result=t||!0,n.waitingList.forEach(function(e){e(t)}),n.waitingList.length=0}}},function(e,t){e.exports={show:function(e){wx.showToast({title:"boolean"==typeof e?"加载中":e,icon:"loading",mask:!0,duration:6e4})},hide:function(){wx.hideToast()}}},function(e,t,n){const o=n(1),i=n(0);var c="session",r=function(){return!1},u=function(e){return e.session_id},s="code",a=function(){return!0},f="",l=function(e){return e},d="操作失败",p=function(e){return e},m=3,g=null,h=!1,y=!1,w=!1,x="",S=!1,T=!1,_=!1;function v(e,t){x?"function"==typeof e&&e():T?i.wait("doLoginFinished",function(){v(e,t)}):(T=!0,t.count++,t._loginStartTime=(new Date).getTime(),wx.login({complete:function(){t.count--,t._loginEndTime=(new Date).getTime(),"function"==typeof h&&h("wx_login",t._loginStartTime,t._loginEndTime,k),"function"==typeof t.complete&&0==t.count&&t.complete()},success:function(n){n.code?(t[s]=n.code,delete t[c],"function"==typeof e&&e()):(b(t,n),console.error(n)),T=!1,i.emit("doLoginFinished")},fail:function(e){b(t,e),console.error(e),T=!1,i.emit("doLoginFinished")}}))}function L(e){var t;return"function"==typeof e.beforeSend&&e.beforeSend(),void 0===e.reLoginLimit?e.reLoginLimit=0:e.reLoginLimit++,void 0===e.count&&(e.count=0),e.showLoading&&(o.show(e.showLoading),e.complete=(t=e.complete,function(){o.hide(),"function"==typeof t&&t.apply(this,arguments)})),e}function k(e){e.count++,e.data||(e.data={}),x&&(e[c]=x);var t={};"function"==typeof w?t=w():"object"==typeof w&&(t=w),e.data=Object.assign({},t,e.data),e.method=e.method||"GET";var n=e.url.startsWith("http")?e.url:f+e.url;for(var o in e[s]&&(n.indexOf("?")>=0?n+="&"+s+"="+e[s]:n+="?"+s+"="+e[s]),e[c]&&(n.indexOf("?")>=0?n+="&"+c+"="+e[c]:n+="?"+c+"="+e[c]),t)n.indexOf("?")>=0?n+="&"+o+"="+t[o]:n+="?"+o+"="+t[o];e.report&&(e._reportStartTime=(new Date).getTime()),wx.request({url:n,data:e.data,method:e.method,header:e.header||{},dataType:e.dataType||"json",success:function(t){if(200==t.statusCode)if(e.report&&"function"==typeof h&&(e._reportEndTime=(new Date).getTime(),h(e.report,e._reportStartTime,e._reportEndTime,k)),u(t.data)&&u(t.data)!=x&&(x=u(t.data),wx.setStorage({key:c,data:u(t.data)})),r(t.data)&&e.reLoginLimit<m)x="",wx.removeStorage({key:c,complete:function(){v(function(){k(e=L(e))},e)}});else if(a(t.data)&&"function"==typeof e.success){var n=null;try{n=l(t.data)}catch(e){console.error("Function successData occur error: "+e)}e.success(n),(!0===e.cache||"function"==typeof e.cache&&e.cache(n))&&wx.setStorage({key:e.url,data:n})}else b(e,t);else b(e,t)},fail:function(t){b(e,t),console.error(t)},complete:function(){e.count--,"function"==typeof e.complete&&0==e.count&&e.complete()}})}function b(e,t){if("function"==typeof e.fail)e.fail(t);else{var n="";if("function"==typeof d)try{n=d(t.data)}catch(e){}else"string"==typeof d&&(n=d);var o="";if("function"==typeof p)try{o=p(t.data)}catch(e){}else"string"==typeof p&&(o=p);wx.showModal({title:n,content:o||"网络或服务异常，请稍后重试",showCancel:!1})}"function"==typeof g&&g(e,t),console.error(t)}e.exports={init:function(e){c=e.sessionName||"session",r=e.loginTrigger||function(){return!1},s=e.codeName||"code",a=e.successTrigger||function(){return!0},u=e.getSession||function(e){return e.session_id},f=e.urlPerfix||"",l=e.successData||function(e){return e},d=e.errorTitle||"操作失败",p=e.errorContent||!1,m=e.reLoginLimit||3,g=e.errorCallback||null,S=e.doNotCheckSession||!1,h=e.reportCGI||!1,y=e.mockJson||!1,w=e.globalData||!1;try{x=wx.getStorageSync(c)||""}catch(e){}},request:function(e){e=L(e),y&&y[e.url]?function(e){var t={data:JSON.parse(JSON.stringify(y[e.url]))};a(t.data)&&"function"==typeof e.success?e.success(l(t.data)):b(e,t),"function"==typeof e.complete&&e.complete()}(e):function(e,t){e.cache?wx.getStorage({key:e.url,success:function(t){"function"==typeof e.cache&&e.cache(t.data)?"function"==typeof e.success&&e.success(t.data):1==e.cache&&"function"==typeof e.success&&e.success(t.data)},fail:function(){t()}}):t()}(e,function(){!function e(t,n){_?i.wait("checkSessionFinished",function(){e(t,n)}):!S&&x?(_=!0,n.count++,n._checkSessionStartTime=(new Date).getTime(),wx.checkSession({success:function(){S=!0},fail:function(){x=""},complete:function(){_=!1,n.count--,n._checkSessionEndTime=(new Date).getTime(),"function"==typeof h&&h("wx_checkSession",n._checkSessionStartTime,n._checkSessionEndTime,k),v(t,n)}})):v(t,n)}(function(){k(e)},e)})},setSession:function(e){x=e,S=!0}}}]);