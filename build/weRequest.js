module.exports=function(t){var e={};function n(o){if(e[o])return e[o].exports;var i=e[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:o})},n.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=2)}([function(t,e){var n={};function o(t){return n[t]||(n[t]={waitingList:[],result:null}),n[t]}t.exports={wait:function(t,e){var n=o(t);n.result?e(n.result):n.waitingList.push(e)},emit:function(t,e){var n=o(t);n.result=e||!0,n.waitingList.forEach(function(t){t(e)}),n.waitingList.length=0}}},function(t,e){t.exports={show:function(t){wx.showToast({title:"boolean"==typeof t?"加载中":t,icon:"loading",mask:!0,duration:6e4})},hide:function(){wx.hideToast()}}},function(t,e,n){const o=n(1),i=n(0);var c="session",r=function(){return!1},u=function(t){return t.session_id},a="code",s=function(){return!0},f="",l=function(t){return t},d="操作失败",p=function(t){return t},m=3,g=null,h=!1,y=!1,w=!1,x="",S=!1,T=!1,_=!1;function v(t,e){x?"function"==typeof t&&t():T?i.wait("doLoginFinished",function(){v(t,e)}):(T=!0,e.count++,e._loginStartTime=(new Date).getTime(),wx.login({complete:function(){e.count--,e._loginEndTime=(new Date).getTime(),"function"==typeof h&&h("wx_login",e._loginStartTime,e._loginEndTime,k),"function"==typeof e.complete&&0==e.count&&e.complete()},success:function(n){n.code?(e[a]=n.code,delete e[c],"function"==typeof t&&t()):(b(e,n),console.error(n)),T=!1,i.emit("doLoginFinished")},fail:function(t){b(e,t),console.error(t),T=!1,i.emit("doLoginFinished")}}))}function L(t){var e;return"function"==typeof t.beforeSend&&t.beforeSend(),void 0===t.reLoginLimit?t.reLoginLimit=0:t.reLoginLimit++,void 0===t.count&&(t.count=0),t.showLoading&&(o.show(t.showLoading),t.complete=(e=t.complete,function(){o.hide(),"function"==typeof e&&e.apply(this,arguments)})),t}function k(t){t.count++,t.data||(t.data={}),x&&(t[c]=x);var e={};"function"==typeof w?e=w():"object"==typeof w&&(e=w),t.data=Object.assign({},e,t.data),t.method=t.method||"GET";var n=t.url.startsWith("http")?t.url:f+t.url;for(var o in t[a]&&(n.indexOf("?")>=0?n+="&"+a+"="+t[a]:n+="?"+a+"="+t[a],t.data[a]=t[a]),t[c]&&(n.indexOf("?")>=0?n+="&"+c+"="+t[c]:n+="?"+c+"="+t[c],t.data[c]=x),e)n.indexOf("?")>=0?n+="&"+o+"="+e[o]:n+="?"+o+"="+e[o];t.report&&(t._reportStartTime=(new Date).getTime()),wx.request({url:n,data:t.data,method:t.method,header:t.header||{},dataType:t.dataType||"json",success:function(e){if(200==e.statusCode)if(t.report&&"function"==typeof h&&(t._reportEndTime=(new Date).getTime(),h(t.report,t._reportStartTime,t._reportEndTime,k)),u(e.data)&&u(e.data)!=x&&(x=u(e.data),wx.setStorage({key:c,data:u(e.data)})),r(e.data)&&t.reLoginLimit<m)x="",wx.removeStorage({key:c,complete:function(){v(function(){k(t=L(t))},t)}});else if(s(e.data)&&"function"==typeof t.success){var n=null;try{n=l(e.data)}catch(t){console.error("Function successData occur error: "+t)}t.success(n),(!0===t.cache||"function"==typeof t.cache&&t.cache(n))&&wx.setStorage({key:t.url,data:n})}else b(t,e);else b(t,e)},fail:function(e){b(t,e),console.error(e)},complete:function(){t.count--,"function"==typeof t.complete&&0==t.count&&t.complete()}})}function b(t,e){if("function"==typeof t.fail)t.fail(e);else{var n="";if("function"==typeof d)try{n=d(e.data)}catch(t){}else"string"==typeof d&&(n=d);var o="";if("function"==typeof p)try{o=p(e.data)}catch(t){}else"string"==typeof p&&(o=p);wx.showModal({title:n,content:o||"网络或服务异常，请稍后重试",showCancel:!1})}"function"==typeof g&&g(t,e),console.error(e)}t.exports={init:function(t){c=t.sessionName||"session",r=t.loginTrigger||function(){return!1},a=t.codeName||"code",s=t.successTrigger||function(){return!0},u=t.getSession||function(t){return t.session_id},f=t.urlPerfix||"",l=t.successData||function(t){return t},d=t.errorTitle||"操作失败",p=t.errorContent||!1,m=t.reLoginLimit||3,g=t.errorCallback||null,S=t.doNotCheckSession||!1,h=t.reportCGI||!1,y=t.mockJson||!1,w=t.globalData||!1;try{x=wx.getStorageSync(c)||""}catch(t){}},request:function(t){t=L(t),y&&y[t.url]?function(t){var e={data:JSON.parse(JSON.stringify(y[t.url]))};s(e.data)&&"function"==typeof t.success?t.success(l(e.data)):b(t,e),"function"==typeof t.complete&&t.complete()}(t):function(t,e){t.cache?wx.getStorage({key:t.url,success:function(e){"function"==typeof t.cache&&t.cache(e.data)?"function"==typeof t.success&&t.success(e.data):1==t.cache&&"function"==typeof t.success&&t.success(e.data)},fail:function(){e()}}):e()}(t,function(){!function t(e,n){_?i.wait("checkSessionFinished",function(){t(e,n)}):!S&&x?(_=!0,n.count++,n._checkSessionStartTime=(new Date).getTime(),wx.checkSession({success:function(){S=!0},fail:function(){x=""},complete:function(){_=!1,n.count--,n._checkSessionEndTime=(new Date).getTime(),"function"==typeof h&&h("wx_checkSession",n._checkSessionStartTime,n._checkSessionEndTime,k),v(e,n)}})):v(e,n)}(function(){k(t)},t)})},setSession:function(t){x=t,S=!0}}}]);